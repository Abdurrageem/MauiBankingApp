<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="MauiBankingExercise.Views.CustomerSelectionPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             Title="Banking Portal"
             BackgroundColor="#F8F9FA">

    <Grid>
        <ScrollView>
            <StackLayout Padding="20" Spacing="25">
                <!-- Header Section -->
                <Frame BackgroundColor="#2C3E50" 
                       CornerRadius="15" 
                       Padding="25"
                       HasShadow="True">
                    <StackLayout Spacing="10">
                        <Label Text="SecureBank" 
                               FontSize="28" 
                               FontAttributes="Bold" 
                               TextColor="White"
                               HorizontalTextAlignment="Center" />
                        <Label Text="Select Your Account" 
                               FontSize="16" 
                               TextColor="#BDC3C7"
                               HorizontalTextAlignment="Center" />
                    </StackLayout>
                </Frame>

                <!-- Customer List -->
                <CollectionView ItemsSource="{Binding Customers}"
                                ItemsLayout="VerticalList"
                                BackgroundColor="Transparent">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <StackLayout Padding="5,10">
                                <Frame BackgroundColor="White" 
                                       CornerRadius="12" 
                                       Padding="20"
                                       HasShadow="True"
                                       BorderColor="#E8E8E8">

                                    <Frame.GestureRecognizers>
                                        <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.SelectCustomerCommand}"
                                                              CommandParameter="{Binding}" />
                                    </Frame.GestureRecognizers>

                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="60" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="30" />
                                        </Grid.ColumnDefinitions>

                                        <!-- Avatar -->
                                        <Frame Grid.Column="0" 
                                               WidthRequest="50" 
                                               HeightRequest="50" 
                                               CornerRadius="25" 
                                               BackgroundColor="#3498DB"
                                               Padding="0"
                                               VerticalOptions="Center">
                                            <Label Text="{Binding FirstName, StringFormat='{0:1}'}" 
                                                   FontSize="20" 
                                                   FontAttributes="Bold" 
                                                   TextColor="White"
                                                   HorizontalTextAlignment="Center"
                                                   VerticalTextAlignment="Center" />
                                        </Frame>

                                        <!-- Customer Info -->
                                        <StackLayout Grid.Column="1" 
                                                     Spacing="6" 
                                                     VerticalOptions="Center"
                                                     Margin="15,0,0,0">
                                            <Label Text="{Binding FullName}" 
                                                   FontSize="18" 
                                                   FontAttributes="Bold" 
                                                   TextColor="#2C3E50" />
                                            <Label Text="{Binding Email}" 
                                                   FontSize="14" 
                                                   TextColor="#7F8C8D" />
                                            <Label Text="{Binding PhoneNumber}" 
                                                   FontSize="14" 
                                                   TextColor="#95A5A6" />
                                        </StackLayout>

                                        <!-- Arrow -->
                                        <Label Grid.Column="2" 
                                               Text=">" 
                                               FontSize="24" 
                                               TextColor="#BDC3C7"
                                               VerticalTextAlignment="Center"
                                               HorizontalTextAlignment="Center" />
                                    </Grid>
                                </Frame>
                            </StackLayout>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

                <!-- Empty State -->
                <StackLayout IsVisible="False">
                    <StackLayout.Triggers>
                        <MultiTrigger TargetType="StackLayout">
                            <MultiTrigger.Conditions>
                                <BindingCondition Binding="{Binding IsLoading}" Value="False" />
                                <BindingCondition Binding="{Binding Customers.Count}" Value="0" />
                            </MultiTrigger.Conditions>
                            <Setter Property="IsVisible" Value="True" />
                        </MultiTrigger>
                    </StackLayout.Triggers>

                    <Frame BackgroundColor="White" 
                           CornerRadius="15" 
                           Padding="30"
                           HasShadow="True">
                        <StackLayout Spacing="15">
                            <Label Text="No Customers Found" 
                                   FontSize="20" 
                                   FontAttributes="Bold" 
                                   TextColor="#7F8C8D"
                                   HorizontalTextAlignment="Center" />
                            <Label Text="The database appears to be empty or still loading." 
                                   FontSize="16" 
                                   TextColor="#95A5A6"
                                   HorizontalTextAlignment="Center" />
                        </StackLayout>
                    </Frame>
                </StackLayout>
            </StackLayout>
        </ScrollView>

        <!-- Loading Indicator -->
        <Frame IsVisible="{Binding IsLoading}" 
               BackgroundColor="#80000000" 
               CornerRadius="10"
               WidthRequest="120" 
               HeightRequest="120"
               VerticalOptions="Center"
               HorizontalOptions="Center"
               Padding="30">
            <StackLayout Spacing="15">
                <ActivityIndicator IsRunning="{Binding IsLoading}"
                                   Color="#3498DB"
                                   WidthRequest="40"
                                   HeightRequest="40" />
                <Label Text="Loading..." 
                       TextColor="White" 
                       FontSize="14"
                       HorizontalTextAlignment="Center" />
            </StackLayout>
        </Frame>
    </Grid>
</ContentPage>